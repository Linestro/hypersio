Tool **hypersio-trace-gen** is a Python script located in a *src/tools* folder.

# Description
The tool reads one or multiple logs recorded by `hypersio-log-collector` and produces three hyper-tenant trace files.
As mentioned in [`hypersio-log-collector` documentation](hypersio_log_collector.md#description), the maximum number of connections
per single `hypersio-log-collector` run is 24. Therefore, to construct a hyper-tenant trace, the tool has to read logs from multiple runs. 
When reading multiple logs, they should all have the form \<log_prefix\>_\<X\>.txt, where *log_prefix* is the same for a group of logs,
and *X* is a log number. This naming convention is met by `hypersio-log-collector.

`hypersio-trace-gen` writes its log into a file in *build/trace_gen_log* folder. Generated logs are saved into
*build/hypersio_traces* folder. Three data files generated by `hypersio-trace-gen` are the following:
- IOLB trace - \*_cc_data.bin. This file a generated hyper-tenant trace of I/O address accesses
- Context Cache data file - \*_cc_data.bin. This file contains context cache data for all tenants in a trace
- SLPT data file - \*_slpt_data.bin. This file contains Second Level Page Table data for all tenants in a trace

All three files are used by `hypersio-perf` tool.

# Parameters
Parameters and their description can be checked by running `hypersio-trace-gen -h`. Required parameters for `hypersio-trace-gen`
are the following:
- `--benchmark <name>` - a name of a benchmark
- `--tenants <num>` - total number of tenants which will be in the final hyper-tenant trace
- `--tenantorder <rr|rand>` - order between tenants. Currently, the tool supports **rr** and **rand**, standing for round-robin and random
tenant interleaving correspondingly.
- `--tenantburstpkt <num>` - number of consecutive packets from a single tenant
- `--loggroupprefix <prefix>` - log prefix used when reading multiple logs.
Read log naming convention in [Description](hypersio_trace_gen.md#description)

# Examples
To generate a hyper-tenant trace for 1024 tenant with random interleaving between them and with a burst size of 3 packets,
run the next command:
```
hypersio-trace-gen --benchmark iperf3 --tenants 1024 --tenantorder rand --tenantburstpkt 3 --loggroupprefix hypersio_iperf3_vm_24_log
```

# Notes
1. `hypersio-trace-gen` tool invokes `hypersio-perf` tool, which implies that the latter one must be compiled before calling the former one.
